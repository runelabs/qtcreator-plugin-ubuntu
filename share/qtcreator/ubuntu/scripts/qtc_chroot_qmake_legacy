#!/bin/bash
# Copyright 2014 Canonical Ltd.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation; version 2.1.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
# Author: Zolt√°n Balogh <zoltan.balogh@canonical.com>

CLICK_CHROOT_FW=$1
shift
CLICK_CHROOT_ARCH=$1
shift
CLICK_CHROOT_NAME=$1
shift

if [ -z "$CLICK_CHROOT_ARCH" ]; then
    echo "Need to set CLICK_CHROOT_ARCH"
    exit 1
fi 

if [ -z "$CLICK_CHROOT_FW" ]; then
    echo "Need to set CLICK_CHROOT_FW"
    exit 1
fi

if [ -z "$CLICK_CHROOT_NAME" ]; then
    echo "Need to set CLICK_CHROOT_NAME"
    exit 1
fi

if [[ $1 != "-query" ]];
then
	exit 1
fi

ARCH_TRIPLET=${CLICK_CHROOT_ARCH/armhf/arm}

if [[ ${ARCH_TRIPLET} = "arm" ]];
then
    POSTFIX="eabihf"
else
    POSTFIX=""
fi

SYSROOT_PATH="/var/lib/schroot/chroots/${CLICK_CHROOT_NAME}-${CLICK_CHROOT_FW}-${CLICK_CHROOT_ARCH}"
QMAKE_PATH="${SYSROOT_PATH}/usr/lib/${ARCH_TRIPLET}-linux-gnu${POSTFIX}/qt5/bin/qmake"



STRINGS=`strings ${QMAKE_PATH}|egrep "qt_ssrtpath|qt_prfxpath|qt_adatpath|qt_datapath|qt_docspath|qt_hdrspath|qt_binspat|qt_libspath|qt_lbexpath|t_tstspath|qt_plugpath|qt_impspath|qt_qml2path|qt_trnspath|qt_stngpath|qt_xmplpath|qt_xmplpath|qt_hpfxpath|qt_hdatpath|qt_hbinpath|qt_hlibpath|qt_hostspec|qt_targspec|Generated by qmake "`

STRINGS=${STRINGS/qt_ssrtpath=/QT_SYSROOT:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_prfxpath=/QT_INSTALL_PREFIX:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_adatpath=/QT_INSTALL_ARCHDATA:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_datapath=/QT_INSTALL_DATA:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_docspath=/QT_INSTALL_DOCS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_hdrspath=/QT_INSTALL_HEADERS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_binspath=/QT_INSTALL_BINS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_libspath=/QT_INSTALL_LIBS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_lbexpath=/QT_INSTALL_LIBEXECS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_tstspath=/QT_INSTALL_TESTS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_plugpath=/QT_INSTALL_PLUGINS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_impspath=/QT_INSTALL_IMPORTS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_qml2path=/QT_INSTALL_QML:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_trnspath=/QT_INSTALL_TRANSLATIONS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_stngpath=/QT_INSTALL_CONFIGURATION:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_xmplpath=/QT_INSTALL_EXAMPLES:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_xmplpath=/QT_INSTALL_DEMOS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_hpfxpath=/QT_HOST_PREFIX:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_hdatpath=/QT_HOST_DATA:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_hbinpath=/QT_HOST_BINS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_hlibpath=/QT_HOST_LIBS:$SYSROOT_PATH}
STRINGS=${STRINGS/qt_hostspec=/QMAKE_SPEC:}
STRINGS=${STRINGS/qt_targspec=/QMAKE_XSPEC:}
STRINGS=${STRINGS//# Generated by qmake (/QMAKE_VERSION:}
STRINGS=${STRINGS//) (Qt /$'\n'QT_VERSION:}
STRINGS=${STRINGS//)/}

echo "$STRINGS"

